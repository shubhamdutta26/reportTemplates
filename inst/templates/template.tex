% !TEX TS-program = xelatex
\documentclass[11pt,letterpaper]{article}

% Required packages
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{titling}
\usepackage{ragged2e}
\usepackage{setspace}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}

% Define Pandoc-specific commands
\newcommand{\pandocbounded}[1]{\csname pandoc#1\endcsname}
\newcommand{\pandoctightlist}{\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\newcommand{\pandocincludegraphics}[2][]{%
  \begin{center}\includegraphics[#1]{#2}\end{center}}

% For strikeout text
\providecommand{\tightlist}{\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\usepackage[normalem]{ulem}
\providecommand{\xspace}{}

% Page geometry
\geometry{
    letterpaper,
    left=1in,
    right=1in,
    top=1in,
    bottom=1in
}

% Custom title formatting
\makeatletter
\renewcommand{\maketitle}{%
    \begin{flushleft}
    {\Large\bfseries \@title\par}
    \vskip 1em
    {\large\@author\par}
    \vskip 0.5em
    $if(affiliation)$
    {\large $affiliation$\par}
    $endif$
    \end{flushleft}
    \vskip 2em
}
\makeatother

% Header and footer style
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\fancyfoot[C]{\thepage}

% Hyperref setup
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,
    urlcolor=blue,
    citecolor=blue
}

% Prevent overfull lines
\setlength{\emergencystretch}{3em}

% Allow breaks at certain characters in URLs
\def\UrlBreaks{\do\/\do-}

% Table settings
\renewcommand{\arraystretch}{1.2}
\setlength{\tabcolsep}{6pt}

% For graphics
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}

% Prevent overfull figure boxes
\setlength{\emergencystretch}{3em}

% Fix for pandoc figure handling
\makeatletter
\def\fps@figure{htbp}
\makeatother

$if(highlighting-macros)$
$highlighting-macros$
$endif$

$if(tables)$
\usepackage{longtable,booktabs,array}
$endif$

% Document start
\begin{document}

$if(title)$
\title{$title$}
$endif$

$if(author)$
\author{$author$}
$endif$

\maketitle

$body$

\end{document}
